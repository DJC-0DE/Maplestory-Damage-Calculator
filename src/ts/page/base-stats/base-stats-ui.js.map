{
  "version": 3,
  "sources": ["base-stats-ui.ts"],
  "sourcesContent": ["// Base Stats UI - HTML Generation and Event Handlers\r\n// This file handles all HTML generation and UI event handling for the base stats tab\r\n\r\nimport { getStatType, isDexMainStatClass, isIntMainStatClass, isLukMainStatClass, isStrMainStatClass } from './class-select';\r\nimport { generateClassSelectorHTML } from './class-select-ui';\r\nimport { generateContentTypeSelectorHTML } from './target-select-ui';\r\nimport {\r\n    generateMasterySectionHTML,\r\n    generateMasteryHiddenInputs\r\n} from './mastery-bonus-ui';\r\nimport { updateSkillCoefficient } from './base-stats';\r\nimport { updateAnalysisTabs } from '@core/state/storage';\r\nimport { extractText, parseBaseStatText } from '@utils/ocr';\r\nimport { getSelectedClass } from '@core/state/state';\r\nimport { showToast } from '@utils/notifications';\r\nimport type { StatInputConfig } from '@ts/types/page/base-stats/base-stats.types';\r\nimport { loadoutStore } from '@ts/store/loadout.store';\r\n\r\n// Import calculate dynamically to avoid circular dependency\r\nfunction getCalculateFunction(): (() => void) | undefined {\r\n    return (window as any).calculate;\r\n}\r\n\r\n// Stat input configuration for generating stat input HTML\r\nconst STAT_INPUTS: StatInputConfig[] = [\r\n    // Core Combat Stats\r\n    { id: 'attack-base', label: 'Attack', type: 'number', value: 500 },\r\n    { id: 'defense-base', label: 'Defense', type: 'number', value: 0, info: 'defense' },\r\n    { id: 'crit-rate-base', label: 'Critical Rate (%)', type: 'number', step: '0.1', value: 15 },\r\n    { id: 'crit-damage-base', label: 'Critical Damage (%)', type: 'number', step: '0.1', value: 15 },\r\n    { id: 'attack-speed-base', label: 'Attack Speed (%)', type: 'number', step: '0.1', value: 0 },\r\n    // Main Stats\r\n    { id: 'str-base', label: 'STR', type: 'number', value: 1000, rowId: 'str-row' },\r\n    { id: 'dex-base', label: 'DEX', type: 'number', value: 0, rowId: 'dex-row' },\r\n    { id: 'int-base', label: 'INT', type: 'number', value: 1000, rowId: 'int-row' },\r\n    { id: 'luk-base', label: 'LUK', type: 'number', value: 0, rowId: 'luk-row' },\r\n    // Damage Modifiers\r\n    { id: 'stat-damage-base', label: 'Stat Prop. Damage (%)', type: 'number', step: '0.1', value: 0 },\r\n    { id: 'damage-base', label: 'Damage (%)', type: 'number', step: '0.1', value: 10 },\r\n    { id: 'damage-amp-base', label: 'Damage Amplification (x)', type: 'number', step: '0.1', value: 0 },\r\n    { id: 'basic-attack-damage-base', label: 'Basic Attack Damage (%)', type: 'number', step: '0.1', value: 0, hidden: true },\r\n    { id: 'skill-damage-base', label: 'Skill Damage (%)', type: 'number', step: '0.1', value: 0, hidden: true },\r\n    { id: 'def-pen-base', label: 'Defense Penetration (%)', type: 'number', step: '0.1', value: 0, info: 'def-pen' },\r\n    { id: 'boss-damage-base', label: 'Boss Monster Damage (%)', type: 'number', step: '0.1', value: 10 },\r\n    { id: 'normal-damage-base', label: 'Normal Monster Damage (%)', type: 'number', step: '0.1', value: 0 },\r\n    { id: 'min-damage-base', label: 'Min Damage Multiplier (%)', type: 'number', step: '0.1', value: 50 },\r\n    { id: 'max-damage-base', label: 'Max Damage Multiplier (%)', type: 'number', step: '0.1', value: 100 },\r\n    { id: 'final-damage-base', label: 'Final Damage (%)', type: 'number', step: '0.1', value: 0 },\r\n    // Skill Levels\r\n    { id: 'skill-level-1st-base', label: '1st Job Skill Level', type: 'number', value: 0, min: 0, onChange: true },\r\n    { id: 'skill-level-2nd-base', label: '2nd Job Skill Level', type: 'number', value: 0, min: 0, onChange: true },\r\n    { id: 'skill-level-3rd-base', label: '3rd Job Skill Level', type: 'number', value: 0, min: 0, onChange: true },\r\n    { id: 'skill-level-4th-base', label: '4th Job Skill Level', type: 'number', value: 0, min: 0, onChange: true },\r\n    // Main Stat %\r\n    { id: 'main-stat-pct-base', label: 'Current Main Stat %', type: 'number', step: '0.1', value: 0, info: 'main-stat-pct' }\r\n];\r\n\r\n/**\r\n * Generate HTML for a single stat input row\r\n */\r\nfunction generateStatInputHTML(stat: StatInputConfig): string {\r\n    const infoIcon = stat.info\r\n        ? `<span class=\"bgstats-info-inline\" role=\"img\" aria-label=\"Info\" onclick=\"openHelpSidebar('${stat.info}')\">?</span>`\r\n        : '';\r\n\r\n    const onChangeAttr = stat.onChange\r\n        ? 'onchange=\"updateSkillCoefficient()\"'\r\n        : '';\r\n\r\n    const hiddenStyle = stat.hidden ? 'style=\"display: none;\"' : '';\r\n    const rowId = stat.rowId ? `id=\"${stat.rowId}\"` : '';\r\n    const minAttr = stat.min !== undefined ? `min=\"${stat.min}\"` : '';\r\n    const stepAttr = stat.step ? `step=\"${stat.step}\"` : '';\r\n\r\n    return `\r\n        <div class=\"bgstats-stat-row\" ${rowId} ${hiddenStyle}>\r\n            <label class=\"bgstats-stat-label\">${stat.label} ${infoIcon}</label>\r\n            <input type=\"${stat.type}\" id=\"${stat.id}\" value=\"${stat.value}\" ${minAttr} ${stepAttr} ${onChangeAttr} class=\"bgstats-stat-input\">\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Generate HTML for stat inputs\r\n */\r\nfunction generateStatInputsHTML(): string {\r\n    let html = '';\r\n\r\n    // Core Combat Stats\r\n    html += STAT_INPUTS.filter(s => ['attack-base', 'defense-base', 'crit-rate-base', 'crit-damage-base', 'attack-speed-base'].includes(s.id))\r\n        .map(generateStatInputHTML).join('');\r\n    html += '<div class=\"bgstats-divider\"></div>';\r\n\r\n    // Main Stats\r\n    html += STAT_INPUTS.filter(s => ['str-base', 'dex-base', 'int-base', 'luk-base'].includes(s.id))\r\n        .map(generateStatInputHTML).join('');\r\n    html += '<div class=\"bgstats-divider\"></div>';\r\n\r\n    // Damage Modifiers\r\n    html += STAT_INPUTS.filter(s => ['stat-damage-base', 'damage-base', 'damage-amp-base', 'basic-attack-damage-base', 'skill-damage-base', 'def-pen-base', 'boss-damage-base', 'normal-damage-base', 'min-damage-base', 'max-damage-base', 'final-damage-base'].includes(s.id))\r\n        .map(generateStatInputHTML).join('');\r\n    html += '<div class=\"bgstats-divider\"></div>';\r\n\r\n    // Skill Levels\r\n    html += STAT_INPUTS.filter(s => ['skill-level-1st-base', 'skill-level-2nd-base', 'skill-level-3rd-base', 'skill-level-4th-base'].includes(s.id))\r\n        .map(generateStatInputHTML).join('');\r\n    html += '<div class=\"bgstats-divider\"></div>';\r\n\r\n    // Main Stat %\r\n    html += STAT_INPUTS.filter(s => ['main-stat-pct-base'].includes(s.id))\r\n        .map(generateStatInputHTML).join('');\r\n\r\n    // Hidden fields\r\n    html += `\r\n        <input type=\"hidden\" id=\"primary-main-stat-base\" value=\"1000\">\r\n        <input type=\"hidden\" id=\"secondary-main-stat-base\" value=\"0\">\r\n        ${generateMasteryHiddenInputs()}\r\n        <input type=\"hidden\" id=\"skill-coeff-base\" value=\"0\">\r\n    `;\r\n\r\n    return html;\r\n}\r\n\r\n/**\r\n * Generate the complete HTML for the base stats tab\r\n */\r\nexport function generateBaseStatsHTML(): string {\r\n    return `\r\n        <!-- Base Stats Container - Premium aesthetic with subtle depth -->\r\n        <div class=\"bgstats-premium-container bg-transparent p-2\">\r\n            <!-- Class Selector - Refined with premium card styling -->\r\n            <div class=\"bgstats-section bgstats-class-section\">\r\n                <div class=\"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-8 gap-2 sm:gap-3\">\r\n                    ${generateClassSelectorHTML()}\r\n                </div>\r\n            </div>\r\n            <div id=\"debug-ocr\"> </div>\r\n\r\n            <!-- Character Level and Job Tier - Premium section styling -->\r\n            <div class=\"bgstats-section bgstats-character-config\">\r\n                <div class=\"grid grid-cols-1 sm:grid-cols-3 gap-3\" style=\"align-items: end;\">\r\n                    <div class=\"input-group\">\r\n                        <label class=\"bgstats-input-label\">Character Level</label>\r\n                        <input type=\"number\" id=\"character-level\" value=\"0\" min=\"0\" max=\"200\" class=\"bgstats-number-input\">\r\n                    </div>\r\n                    <div class=\"input-group\">\r\n                        <label class=\"bgstats-input-label\">Job Tier</label>\r\n                        <div class=\"flex gap-2\">\r\n                            <button id=\"job-tier-3rd\" class=\"bgstats-tier-btn active\">\r\n                                3rd Job\r\n                            </button>\r\n                            <button id=\"job-tier-4th\" class=\"bgstats-tier-btn\">\r\n                                4th Job\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                    <section class=\"paste-image-section bgstats-paste-section\" id=\"base-stats-paste-image-section\" style=\"width: 100%;height: 42px; min-height: 42px;\">\r\n                        <div class=\"paste-icon bgstats-paste-btn\" style=\"display: flex; align-items: center; justify-content: center; width: 100%; height: 100%;\"><strong>Auto-fill Stats</strong> \uD83D\uDCCB</div>\r\n                        <span class=\"info-icon bgstats-info-icon\" role=\"img\" aria-label=\"Info\" onclick=\"openHelpSidebar('stats-autofill')\" style=\"position: absolute; right: 8px; top: 50%; transform: translateY(-50%); font-size: 0.75rem; width: 18px; height: 18px;\">?</span>\r\n                    </section>\r\n                </div>\r\n            </div>\r\n\r\n            <!-- Sub-tabs for Stats and Skill Mastery -->\r\n            <div class=\"optimization-sub-tabs\" style=\"display: none;\">\r\n                <button class=\"optimization-sub-tab-button active\">Stats</button>\r\n                <button class=\"optimization-sub-tab-button\">Skill Mastery</button>\r\n                <button style=\"display: none;\" class=\"optimization-sub-tab-button\">Skill Details</button>\r\n            </div>\r\n\r\n            <!-- Character Stats Sub-tab -->\r\n            <div id=\"base-stats-character-stats\" class=\"base-stats-subtab active\">\r\n                <!-- Two-column container: Stats on left, Target Content on right -->\r\n                <div class=\"stats-two-column-container\">\r\n                    <!-- Left Column: Stats List -->\r\n                    <div class=\"stats-list-column\">\r\n                        ${generateStatInputsHTML()}\r\n                    </div>\r\n\r\n                    <!-- Right Column: Skill Mastery and Target Content -->\r\n                    <div class=\"right-column-stack\">\r\n                        ${generateMasterySectionHTML()}\r\n\r\n                        <!-- Target Content Type Section - Premium redesign -->\r\n                        <div class=\"bgstats-target-section\">\r\n                            <label class=\"bgstats-target-label\">Target Content Type <span class=\"bgstats-info-inline\" role=\"img\" aria-label=\"Info\" onclick=\"openHelpSidebar('target-stage')\">?</span></label>\r\n                            <div class=\"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-2 mb-3\">\r\n                                ${generateContentTypeSelectorHTML()}\r\n                            </div>\r\n                            <!-- Sub-category selector for Stage Hunts and Growth Dungeons -->\r\n                            <select id=\"target-subcategory\" class=\"bgstats-select mb-2\" style=\"display: none;\">\r\n                                <!-- Populated by JavaScript based on content type -->\r\n                            </select>\r\n                            <!-- Final stage selection -->\r\n                            <select id=\"target-stage-base\" class=\"bgstats-select\" style=\"display: none;\">\r\n                                <!-- Populated by JavaScript based on content type/subcategory selection -->\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                    <!-- End Right Column -->\r\n                </div>\r\n            </div>\r\n            <!-- End Character Stats Sub-tab -->\r\n\r\n            <!-- Skill Details Sub-tab - Consistent premium styling -->\r\n            <div id=\"base-stats-skill-details\" class=\"base-stats-subtab\" style=\"display: none;\">\r\n                <div class=\"bgstats-info-banner\">\r\n                    <div style=\"color: var(--text-primary); font-size: 0.9em; line-height: 1.5;\">\r\n                        <strong style=\"color: var(--accent-primary);\">Instructions:</strong> Click on a skill to view its description with calculated values based on your character level.\r\n                    </div>\r\n                </div>\r\n\r\n                <div style=\"display: grid; grid-template-columns: auto 1fr; gap: 20px;\">\r\n                    <!-- Left Panel: Compact Skill Icons -->\r\n                    <div class=\"bgstats-skills-panel\">\r\n                        <!-- Skills -->\r\n                        <div style=\"margin-bottom: 15px;\">\r\n                            <div class=\"bgstats-panel-section-title\">Skills</div>\r\n                            <div style=\"display: flex; flex-direction: column; gap: 8px;\">\r\n                                <div style=\"display: flex; gap: 6px; flex-wrap: wrap; max-width: 300px;\">\r\n                                    <div id=\"skill-grid-skills-2nd\" style=\"display: contents;\"></div>\r\n                                    <div id=\"skill-grid-skills-3rd\" style=\"display: contents;\"></div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <!-- Passives -->\r\n                        <div>\r\n                            <div class=\"bgstats-panel-section-title\">Passives</div>\r\n                            <div style=\"display: flex; flex-direction: column; gap: 8px;\">\r\n                                <div style=\"display: flex; gap: 6px; flex-wrap: wrap; max-width: 300px;\">\r\n                                    <div id=\"skill-grid-passives-2nd\" style=\"display: contents;\"></div>\r\n                                    <div id=\"skill-grid-passives-3rd\" style=\"display: contents;\"></div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <!-- Right Panel: Skill Description -->\r\n                    <div id=\"skill-description-panel\" class=\"bgstats-description-panel\">\r\n                        <div style=\"text-align: center; color: var(--text-secondary); padding: 40px 20px;\">\r\n                            Select a skill to view its details\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <!-- End Skill Details Sub-tab -->\r\n        </div>\r\n    `;\r\n}\r\n\r\n/**\r\n * Attach event listeners to character level input\r\n */\r\nfunction attachCharacterLevelListener(): void {\r\n    const levelInput = document.getElementById('character-level') as HTMLInputElement;\r\n    if (levelInput) {\r\n        levelInput.addEventListener('change', () => {\r\n            const level = parseInt(levelInput.value) || 0;\r\n            updateSkillCoefficient();\r\n            // Save via loadout store (auto dual-writes to localStorage)\r\n            loadoutStore.updateCharacter({ level });\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Attach event listeners to sub-tab buttons\r\n */\r\nfunction attachSubTabListeners(): void {\r\n    const subTabContainer = document.querySelector('.optimization-sub-tabs');\r\n    if (!subTabContainer) return;\r\n\r\n    const buttons = subTabContainer.querySelectorAll('.optimization-sub-tab-button');\r\n    const subTabs: Record<string, string> = {\r\n        'Stats': 'character-stats',\r\n        'Skill Mastery': 'skill-mastery',\r\n        'Skill Details': 'skill-details'\r\n    };\r\n\r\n    buttons.forEach(button => {\r\n        button.addEventListener('click', () => {\r\n            const tabName = subTabs[button.textContent || ''];\r\n            if (tabName) {\r\n                switchBaseStatsSubTab(tabName);\r\n            }\r\n        });\r\n    });\r\n}\r\n\r\n/**\r\n * Attach event listener for paste area (OCR stat extraction)\r\n */\r\nfunction attachPasteAreaListener(): void {\r\n    const pasteArea = document.getElementById('base-stats-paste-image-section');\r\n    if (!pasteArea) return;\r\n\r\n    pasteArea.addEventListener('paste', async (event: ClipboardEvent) => {\r\n        const items = Array.from(event.clipboardData?.items || []);\r\n        const pastedImage = items.filter(x => x.type.startsWith(\"image/\"))[0];\r\n        if (!pastedImage) return;\r\n\r\n        const file = pastedImage.getAsFile();\r\n        if (!file) return;\r\n\r\n        const imageURL = URL.createObjectURL(file);\r\n        const extractedText = await extractText(imageURL, false);\r\n        try {\r\n            const parsedStats = parseBaseStatText(extractedText);\r\n            for (const parsedStat of parsedStats) {\r\n                const inputElement = document.getElementById(parsedStat[0]) as HTMLInputElement;\r\n                if (inputElement) {\r\n                    inputElement.value = parsedStat[1];\r\n                    // Add a permanent outline until the input is changed again\r\n                    inputElement.style.outline = '2px solid #95b993'; // Outline color\r\n                    inputElement.addEventListener('input', () => {\r\n                        inputElement.style.outline = ''; // Reset to default on change\r\n                    }, { once: true });\r\n\r\n                    const className = getSelectedClass();\r\n                    const primaryInput = document.getElementById('primary-main-stat-base') as HTMLInputElement;\r\n                    const secondaryInput = document.getElementById('secondary-main-stat-base') as HTMLInputElement;\r\n\r\n                    const statType = getStatType(className, parsedStat[0]);\r\n                    if (statType === 'primary') {\r\n                        primaryInput.value = parsedStat[1] || '1000';\r\n                    } else if (statType === 'secondary') {\r\n                        secondaryInput.value = parsedStat[1] || '1000';\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (parsedStats.length > 0) {\r\n                showToast(`Parsing successful! ${parsedStats.length} stats updated`, true);\r\n            } else {\r\n                showToast(\"Parsing failed! Make sure you are ONLY screenshotting the stats rows from the Character page and nothing else\", false);\r\n            }\r\n\r\n            // Save all parsed stats via loadout store (auto dual-writes to localStorage)\r\n            const baseStatUpdates: Record<string, number> = {};\r\n            for (const parsedStat of parsedStats) {\r\n                const key = parsedStat[0].replace('-base', '');\r\n                const value = parseFloat(parsedStat[1]) || 0;\r\n                baseStatUpdates[key] = value;\r\n            }\r\n            loadoutStore.updateBaseStats(baseStatUpdates);\r\n\r\n            const calculate = getCalculateFunction();\r\n            if (calculate) calculate();\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n            showToast(String(e), false);\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * Attach event listeners to main stat inputs for syncing with hidden fields\r\n */\r\nfunction attachMainStatSyncListeners(): void {\r\n    const strInput = document.getElementById('str-base') as HTMLInputElement;\r\n    const dexInput = document.getElementById('dex-base') as HTMLInputElement;\r\n    const intInput = document.getElementById('int-base') as HTMLInputElement;\r\n    const lukInput = document.getElementById('luk-base') as HTMLInputElement;\r\n\r\n    [strInput, dexInput, intInput, lukInput].forEach(input => {\r\n        if (input) {\r\n            input.addEventListener('input', () => {\r\n                syncMainStatsToHidden();\r\n                // Save via loadout store (auto dual-writes to localStorage)\r\n                const value = parseFloat(input.value) || 0;\r\n                const key = input.id.replace('-base', '');\r\n                loadoutStore.updateBaseStat(key, value);\r\n            });\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * Attach event listeners to all stat inputs for saving to loadout store\r\n */\r\nfunction attachStatInputListeners(): void {\r\n    // All stat input IDs\r\n    const statInputIds = [\r\n        'attack-base', 'defense-base', 'crit-rate-base', 'crit-damage-base', 'attack-speed-base',\r\n        'stat-damage-base', 'damage-base', 'damage-amp-base', 'def-pen-base',\r\n        'boss-damage-base', 'normal-damage-base', 'min-damage-base', 'max-damage-base', 'final-damage-base',\r\n        'skill-level-1st-base', 'skill-level-2nd-base', 'skill-level-3rd-base', 'skill-level-4th-base',\r\n        'main-stat-pct-base'\r\n    ];\r\n\r\n    statInputIds.forEach(id => {\r\n        const input = document.getElementById(id) as HTMLInputElement;\r\n        if (input) {\r\n            input.addEventListener('input', () => {\r\n                const value = parseFloat(input.value) || 0;\r\n                const key = id.replace('-base', '');\r\n                loadoutStore.updateBaseStat(key, value);\r\n            });\r\n        }\r\n    });\r\n}\r\n\r\n// Sync main stat inputs (STR, DEX, INT, LUK) with hidden primary/secondary fields\r\nexport function syncMainStatsToHidden() {\r\n    const className = getSelectedClass();\r\n    const strInput = document.getElementById('str-base') as HTMLInputElement;\r\n    const dexInput = document.getElementById('dex-base') as HTMLInputElement;\r\n    const intInput = document.getElementById('int-base') as HTMLInputElement;\r\n    const lukInput = document.getElementById('luk-base') as HTMLInputElement;\r\n    const primaryInput = document.getElementById('primary-main-stat-base') as HTMLInputElement;\r\n    const secondaryInput = document.getElementById('secondary-main-stat-base') as HTMLInputElement;\r\n\r\n    if (!primaryInput || !secondaryInput) return;\r\n\r\n    // Map class to primary/secondary stats\r\n    if (isStrMainStatClass(className)) {\r\n        // Warriors: STR (primary), DEX (secondary)\r\n        if (strInput) primaryInput.value = strInput.value || '1000';\r\n        if (dexInput) secondaryInput.value = dexInput.value || '0';\r\n    } else if (isDexMainStatClass(className)) {\r\n        // Archers: DEX (primary), STR (secondary)\r\n        if (dexInput) primaryInput.value = dexInput.value || '1000';\r\n        if (strInput) secondaryInput.value = strInput.value || '0';\r\n    } else if (isIntMainStatClass(className)) {\r\n        // Mages: INT (primary), LUK (secondary)\r\n        if (intInput) primaryInput.value = intInput.value || '1000';\r\n        if (lukInput) secondaryInput.value = lukInput.value || '0';\r\n    } else if (isLukMainStatClass(className)) {\r\n        // Thieves: LUK (primary), DEX (secondary)\r\n        if (lukInput) primaryInput.value = lukInput.value || '1000';\r\n        if (dexInput) secondaryInput.value = dexInput.value || '0';\r\n    }\r\n}\r\n\r\n/**\r\n * Switch between base stats sub-tabs\r\n */\r\nfunction switchBaseStatsSubTab(subTabName: string): void {\r\n    // Hide all sub-tabs\r\n    const subTabs = document.querySelectorAll('.base-stats-subtab');\r\n    subTabs.forEach(tab => {\r\n        (tab as HTMLElement).style.display = 'none';\r\n    });\r\n\r\n    // Show the selected sub-tab\r\n    const selectedTab = document.getElementById(`base-stats-${subTabName}`);\r\n    if (selectedTab) {\r\n        selectedTab.style.display = 'block';\r\n    }\r\n\r\n    // Update button states - get the parent container's buttons\r\n    const buttons = document.querySelectorAll('#setup-base-stats .optimization-sub-tab-button');\r\n    buttons.forEach(button => {\r\n        button.classList.remove('active');\r\n    });\r\n\r\n    // Activate button by index\r\n    const tabIndex: Record<string, number> = { 'character-stats': 0, 'skill-mastery': 1, 'skill-details': 2 };\r\n    if (tabIndex[subTabName] !== undefined && buttons[tabIndex[subTabName]]) {\r\n        buttons[tabIndex[subTabName]].classList.add('active');\r\n    }\r\n\r\n    // If switching to skill details, populate the skills (handled by main.js)\r\n    if (subTabName === 'skill-details') {\r\n        // Trigger populateSkillDetails from main.js via window\r\n        if ((window as any).populateSkillDetails) {\r\n            (window as any).populateSkillDetails();\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Initialize the base stats UI - generates HTML only\r\n */\r\nexport function initializeBaseStatsUI(): void {\r\n    const container = document.getElementById('setup-base-stats');\r\n    if (!container) {\r\n        console.error('Base stats container not found');\r\n        return;\r\n    }\r\n\r\n    // Generate HTML only - no event listeners attached here\r\n    container.innerHTML = generateBaseStatsHTML();\r\n}\r\n\r\n/**\r\n * Load base stats UI from saved state\r\n */\r\nexport function loadBaseStatsUI(): void {\r\n    const character = loadoutStore.getCharacter();\r\n    const baseStats = loadoutStore.getBaseStats();\r\n\r\n    // Load character level\r\n    const levelInput = document.getElementById('character-level') as HTMLInputElement;\r\n    if (levelInput && character.level > 0) {\r\n        levelInput.value = character.level.toString();\r\n    }\r\n\r\n    // Load all stat inputs from store\r\n    const statInputIds = [\r\n        'attack', 'defense', 'crit-rate', 'crit-damage', 'attack-speed',\r\n        'str', 'dex', 'int', 'luk',\r\n        'stat-damage', 'damage', 'damage-amp', 'def-pen',\r\n        'boss-damage', 'normal-damage', 'min-damage', 'max-damage', 'final-damage',\r\n        'skill-level-1st', 'skill-level-2nd', 'skill-level-3rd', 'skill-level-4th',\r\n        'main-stat-pct'\r\n    ];\r\n\r\n    statInputIds.forEach(key => {\r\n        // Only set value if the key exists in baseStats (even if value is 0)\r\n        // If key doesn't exist, let the HTML default value be used\r\n        if (key in baseStats) {\r\n            const input = document.getElementById(`${key}-base`) as HTMLInputElement;\r\n            if (input) {\r\n                input.value = baseStats[key].toString();\r\n            }\r\n        }\r\n    });\r\n\r\n    // Sync main stats to hidden fields\r\n    syncMainStatsToHidden();\r\n}\r\n\r\n/**\r\n * Attach all event listeners for the base stats UI\r\n */\r\nexport function attachBaseStatsEventListeners(): void {\r\n    attachCharacterLevelListener();\r\n    attachSubTabListeners();\r\n    attachPasteAreaListener();\r\n    attachMainStatSyncListeners();\r\n    attachStatInputListeners();\r\n}\r\n\r\n// Expose switchBaseStatsSubTab to window for global access\r\n(window as any).switchBaseStatsSubTab = switchBaseStatsSubTab;\r\n"],
  "mappings": "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",
  "names": []
}
