{
  "version": 3,
  "sources": ["target-select-ui.ts"],
  "sourcesContent": ["/**\r\n * DOM manipulation layer for Target/Stage selection\r\n * All functions handle only DOM operations and delegate logic to target-select.ts\r\n */\r\nimport { CONTENT_TYPE } from '@ts/types/constants';\r\nimport type { ContentType } from '@ts/types';\r\nimport type { ContentTypeConfig } from '@ts/types/page/base-stats/base-stats.types';\r\nimport {\r\n    getSubcategoryOptions,\r\n    getFilteredStageEntries,\r\n    formatStageLabel,\r\n    requiresSubcategory,\r\n    SavedContentTypeData\r\n} from './target-select';\r\nimport { loadoutStore } from '@ts/store/loadout.store';\r\n\r\n// Content type configuration for generating content selector HTML\r\nconst CONTENT_TYPES: ContentTypeConfig[] = [\r\n    { id: CONTENT_TYPE.NONE, name: 'None', icon: '\uD83C\uDFAF', title: 'Training Dummy' },\r\n    { id: CONTENT_TYPE.STAGE_HUNT, name: 'Stage Hunt', icon: '\uD83D\uDDFA\uFE0F', title: 'Stage Hunt' },\r\n    { id: CONTENT_TYPE.CHAPTER_BOSS, name: 'Chapter Boss', icon: '\uD83D\uDC51', title: 'Chapter Boss' },\r\n    { id: CONTENT_TYPE.WORLD_BOSS, name: 'World Boss', icon: '\uD83C\uDF0D', title: 'World Boss' },\r\n    { id: CONTENT_TYPE.GROWTH_DUNGEON, name: 'Growth Dungeon', icon: '\uD83D\uDCC8', title: 'Growth Dungeon' }\r\n];\r\n\r\n// ============================================================================\r\n// WINDOW GLOBALS - HTML onclick handlers\r\n// ============================================================================\r\n\r\nif (typeof window !== 'undefined') {\r\n    window.selectContentType = selectContentType;\r\n    window.onSubcategoryChange = onSubcategoryChange;\r\n}\r\n\r\n// ============================================================================\r\n// USER INTERACTION METHODS\r\n// ============================================================================\r\n\r\n/**\r\n * Handle user clicking on a content type button\r\n */\r\nexport function selectContentType(contentType: ContentType): void {\r\n    updateContentTypeSelectionUI(contentType);\r\n    configureDropdownsForContentType(contentType);\r\n\r\n    // Save via loadout store (auto dual-writes to localStorage)\r\n    loadoutStore.updateTarget({ contentType });\r\n    //updateAnalysisTabs();\r\n}\r\n\r\n/**\r\n * Handle user changing the subcategory dropdown\r\n */\r\nexport function onSubcategoryChange(): void {\r\n    const subcategorySelect = document.getElementById('target-subcategory') as HTMLSelectElement;\r\n    const stageSelect = document.getElementById('target-stage') as HTMLSelectElement;\r\n    if (!subcategorySelect || !stageSelect) return;\r\n\r\n    const subcategory = subcategorySelect.value;\r\n    const target = loadoutStore.getTarget();\r\n\r\n    if (target.contentType === CONTENT_TYPE.STAGE_HUNT) {\r\n        const chapter = subcategory.replace('chapter-', '');\r\n        populateStageDropdownFiltered(CONTENT_TYPE.STAGE_HUNT, chapter);\r\n    } else if (target.contentType === CONTENT_TYPE.GROWTH_DUNGEON) {\r\n        populateStageDropdownFiltered(CONTENT_TYPE.GROWTH_DUNGEON, subcategory);\r\n    }\r\n\r\n    stageSelect.style.display = 'block';\r\n\r\n    // Save subcategory only - selectedStage is saved by the stage dropdown's own change event listener\r\n    loadoutStore.updateTarget({ subcategory });\r\n    //updateAnalysisTabs();\r\n}\r\n\r\n// ============================================================================\r\n// INITIALIZATION METHODS\r\n// ============================================================================\r\n\r\n/**\r\n * Load target select UI from saved state\r\n */\r\nexport function loadTargetSelectUI(): void {\r\n    const target = loadoutStore.getTarget();\r\n\r\n    restoreSavedSelectionUI({ contentType: target.contentType, subcategory: target.subcategory, selectedStage: target.selectedStage });\r\n}\r\n\r\n// ============================================================================\r\n// STATE INITIALIZATION (UI-LESS)\r\n// ============================================================================\r\n\r\nfunction initializeWithDefaultState(): void {\r\n    loadoutStore.updateTarget({ contentType: CONTENT_TYPE.NONE});\r\n}\r\n\r\n// ============================================================================\r\n// UI RESTORATION\r\n// ============================================================================\r\n\r\nfunction restoreSavedSelectionUI(savedData: SavedContentTypeData): void {\r\n    const { contentType, subcategory, selectedStage } = savedData;\r\n\r\n    updateContentTypeSelectionUI(contentType);\r\n    configureDropdownsForContentType(contentType);\r\n\r\n    if (subcategory && requiresSubcategory(contentType)) {\r\n        const subcategorySelect = document.getElementById('target-subcategory') as HTMLSelectElement;\r\n        if (subcategorySelect) {\r\n            subcategorySelect.value = subcategory;\r\n\r\n            if (contentType === CONTENT_TYPE.STAGE_HUNT) {\r\n                const chapter = subcategory.replace('chapter-', '');\r\n                populateStageDropdownFiltered(CONTENT_TYPE.STAGE_HUNT, chapter);\r\n            } else if (contentType === CONTENT_TYPE.GROWTH_DUNGEON) {\r\n                populateStageDropdownFiltered(CONTENT_TYPE.GROWTH_DUNGEON, subcategory);\r\n            }\r\n\r\n            // Show the stage select after populating it\r\n            const stageSelect = document.getElementById('target-stage') as HTMLSelectElement;\r\n            if (stageSelect) {\r\n                stageSelect.style.display = 'block';\r\n            }\r\n        }\r\n    }\r\n\r\n    if (selectedStage) {\r\n        const stageSelect = document.getElementById('target-stage') as HTMLSelectElement;\r\n        if (stageSelect) {\r\n            stageSelect.value = selectedStage;\r\n        }\r\n    }\r\n}\r\n\r\n// ============================================================================\r\n// UI HELPERS\r\n// ============================================================================\r\n\r\nfunction updateContentTypeSelectionUI(contentType: ContentType): void {\r\n    document.querySelectorAll('.content-type-selector').forEach(el => {\r\n        el.classList.remove('selected');\r\n    });\r\n\r\n    const selectedEl = document.getElementById(`content-${contentType}`);\r\n    if (selectedEl) {\r\n        selectedEl.classList.add('selected');\r\n    }\r\n\r\n    const subcategorySelect = document.getElementById('target-subcategory') as HTMLSelectElement;\r\n    const stageSelect = document.getElementById('target-stage') as HTMLSelectElement;\r\n\r\n    if (subcategorySelect) subcategorySelect.style.display = 'none';\r\n    if (stageSelect) stageSelect.style.display = 'none';\r\n}\r\n\r\nfunction configureDropdownsForContentType(contentType: ContentType): void {\r\n    const subcategorySelect = document.getElementById('target-subcategory') as HTMLSelectElement;\r\n    const stageSelect = document.getElementById('target-stage') as HTMLSelectElement;\r\n    if (!stageSelect) return;\r\n\r\n    if (contentType === CONTENT_TYPE.NONE) {\r\n        stageSelect.value = 'none';\r\n        return;\r\n    }\r\n\r\n    if (requiresSubcategory(contentType)) {\r\n        populateSubcategoryDropdown(contentType);\r\n        stageSelect.style.display = 'block';\r\n    } else {\r\n        stageSelect.style.display = 'block';\r\n        populateStageDropdown(contentType);\r\n    }\r\n}\r\n\r\nfunction populateSubcategoryDropdown(contentType: ContentType): void {\r\n    const select = document.getElementById('target-subcategory') as HTMLSelectElement;\r\n    if (!select) return;\r\n\r\n    select.innerHTML = '';\r\n\r\n    const options = getSubcategoryOptions(contentType);\r\n    options.forEach(opt => {\r\n        const option = document.createElement('option');\r\n        option.value = opt.value;\r\n        option.textContent = opt.label;\r\n        select.appendChild(option);\r\n    });\r\n}\r\n\r\nfunction populateStageDropdown(contentType: ContentType): void {\r\n    const select = document.getElementById('target-stage') as HTMLSelectElement;\r\n    if (!select) return;\r\n\r\n    select.innerHTML = '';\r\n\r\n    const entries = getFilteredStageEntries(contentType, contentType);\r\n\r\n    entries.forEach(({ entry, identifier, prefix }) => {\r\n        const opt = document.createElement('option');\r\n        opt.value = `${prefix}-${identifier}`;\r\n        opt.textContent = formatStageLabel(entry, identifier, contentType);\r\n        select.appendChild(opt);\r\n    });\r\n}\r\n\r\nfunction populateStageDropdownFiltered(contentType: ContentType, filter: string): void {\r\n    const select = document.getElementById('target-stage') as HTMLSelectElement;\r\n    if (!select) return;\r\n\r\n    select.innerHTML = '';\r\n\r\n    const entries = getFilteredStageEntries(contentType, filter);\r\n\r\n    entries.forEach(({ entry, identifier, prefix }) => {\r\n        const opt = document.createElement('option');\r\n        opt.value = `${prefix}-${identifier}`;\r\n        opt.textContent = formatStageLabel(entry, identifier, contentType);\r\n        select.appendChild(opt);\r\n    });\r\n}\r\n\r\n// ============================================================================\r\n// EVENT LISTENERS\r\n// ============================================================================\r\n\r\n/**\r\n * Attach event listeners to content type selector cards\r\n */\r\nfunction attachContentTypeSelectorListeners(): void {\r\n    CONTENT_TYPES.forEach(content => {\r\n        const element = document.getElementById(`content-${content.id}`);\r\n        if (element) {\r\n            element.addEventListener('click', () => selectContentType(content.id));\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * Attach event listeners to target content dropdowns\r\n */\r\nfunction attachTargetContentListeners(): void {\r\n    const subcategorySelect = document.getElementById('target-subcategory') as HTMLSelectElement;\r\n    const stageSelect = document.getElementById('target-stage') as HTMLSelectElement;\r\n\r\n    if (subcategorySelect) {\r\n        subcategorySelect.addEventListener('change', () => onSubcategoryChange());\r\n    }\r\n\r\n    if (stageSelect) {\r\n        stageSelect.addEventListener('change', () => {\r\n            // Save via loadout store (auto dual-writes to localStorage)\r\n            const stageValue = stageSelect.value;\r\n            loadoutStore.updateTarget({ selectedStage: stageValue });\r\n           // updateAnalysisTabs();\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Attach all event listeners for target select UI\r\n */\r\nexport function attachTargetSelectEventListeners(): void {\r\n    attachContentTypeSelectorListeners();\r\n    attachTargetContentListeners();\r\n}\r\n\r\n// ============================================================================\r\n// HTML GENERATION\r\n// ============================================================================\r\n\r\n/**\r\n * Generate HTML for content type selector cards\r\n */\r\nexport function generateContentTypeSelectorHTML(): string {\r\n    return CONTENT_TYPES.map(content => `\r\n        <div id=\"content-${content.id}\" class=\"content-type-selector bgstats-content-card\" title=\"${content.title}\">\r\n            <span class=\"bgstats-content-icon\">${content.icon}</span>\r\n            <span class=\"bgstats-content-name\">${content.name}</span>\r\n        </div>\r\n    `).join('');\r\n}\r\n"],
  "mappings": "AAIA,SAAS,oBAAoB;AAG7B;AAAA,EACI;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,OAEG;AACP,SAAS,oBAAoB;AAG7B,MAAM,gBAAqC;AAAA,EACvC,EAAE,IAAI,aAAa,MAAM,MAAM,QAAQ,MAAM,aAAM,OAAO,iBAAiB;AAAA,EAC3E,EAAE,IAAI,aAAa,YAAY,MAAM,cAAc,MAAM,mBAAO,OAAO,aAAa;AAAA,EACpF,EAAE,IAAI,aAAa,cAAc,MAAM,gBAAgB,MAAM,aAAM,OAAO,eAAe;AAAA,EACzF,EAAE,IAAI,aAAa,YAAY,MAAM,cAAc,MAAM,aAAM,OAAO,aAAa;AAAA,EACnF,EAAE,IAAI,aAAa,gBAAgB,MAAM,kBAAkB,MAAM,aAAM,OAAO,iBAAiB;AACnG;AAMA,IAAI,OAAO,WAAW,aAAa;AAC/B,SAAO,oBAAoB;AAC3B,SAAO,sBAAsB;AACjC;AASO,SAAS,kBAAkB,aAAgC;AAC9D,+BAA6B,WAAW;AACxC,mCAAiC,WAAW;AAG5C,eAAa,aAAa,EAAE,YAAY,CAAC;AAE7C;AAKO,SAAS,sBAA4B;AACxC,QAAM,oBAAoB,SAAS,eAAe,oBAAoB;AACtE,QAAM,cAAc,SAAS,eAAe,cAAc;AAC1D,MAAI,CAAC,qBAAqB,CAAC,YAAa;AAExC,QAAM,cAAc,kBAAkB;AACtC,QAAM,SAAS,aAAa,UAAU;AAEtC,MAAI,OAAO,gBAAgB,aAAa,YAAY;AAChD,UAAM,UAAU,YAAY,QAAQ,YAAY,EAAE;AAClD,kCAA8B,aAAa,YAAY,OAAO;AAAA,EAClE,WAAW,OAAO,gBAAgB,aAAa,gBAAgB;AAC3D,kCAA8B,aAAa,gBAAgB,WAAW;AAAA,EAC1E;AAEA,cAAY,MAAM,UAAU;AAG5B,eAAa,aAAa,EAAE,YAAY,CAAC;AAE7C;AASO,SAAS,qBAA2B;AACvC,QAAM,SAAS,aAAa,UAAU;AAEtC,0BAAwB,EAAE,aAAa,OAAO,aAAa,aAAa,OAAO,aAAa,eAAe,OAAO,cAAc,CAAC;AACrI;AAMA,SAAS,6BAAmC;AACxC,eAAa,aAAa,EAAE,aAAa,aAAa,KAAI,CAAC;AAC/D;AAMA,SAAS,wBAAwB,WAAuC;AACpE,QAAM,EAAE,aAAa,aAAa,cAAc,IAAI;AAEpD,+BAA6B,WAAW;AACxC,mCAAiC,WAAW;AAE5C,MAAI,eAAe,oBAAoB,WAAW,GAAG;AACjD,UAAM,oBAAoB,SAAS,eAAe,oBAAoB;AACtE,QAAI,mBAAmB;AACnB,wBAAkB,QAAQ;AAE1B,UAAI,gBAAgB,aAAa,YAAY;AACzC,cAAM,UAAU,YAAY,QAAQ,YAAY,EAAE;AAClD,sCAA8B,aAAa,YAAY,OAAO;AAAA,MAClE,WAAW,gBAAgB,aAAa,gBAAgB;AACpD,sCAA8B,aAAa,gBAAgB,WAAW;AAAA,MAC1E;AAGA,YAAM,cAAc,SAAS,eAAe,cAAc;AAC1D,UAAI,aAAa;AACb,oBAAY,MAAM,UAAU;AAAA,MAChC;AAAA,IACJ;AAAA,EACJ;AAEA,MAAI,eAAe;AACf,UAAM,cAAc,SAAS,eAAe,cAAc;AAC1D,QAAI,aAAa;AACb,kBAAY,QAAQ;AAAA,IACxB;AAAA,EACJ;AACJ;AAMA,SAAS,6BAA6B,aAAgC;AAClE,WAAS,iBAAiB,wBAAwB,EAAE,QAAQ,QAAM;AAC9D,OAAG,UAAU,OAAO,UAAU;AAAA,EAClC,CAAC;AAED,QAAM,aAAa,SAAS,eAAe,WAAW,WAAW,EAAE;AACnE,MAAI,YAAY;AACZ,eAAW,UAAU,IAAI,UAAU;AAAA,EACvC;AAEA,QAAM,oBAAoB,SAAS,eAAe,oBAAoB;AACtE,QAAM,cAAc,SAAS,eAAe,cAAc;AAE1D,MAAI,kBAAmB,mBAAkB,MAAM,UAAU;AACzD,MAAI,YAAa,aAAY,MAAM,UAAU;AACjD;AAEA,SAAS,iCAAiC,aAAgC;AACtE,QAAM,oBAAoB,SAAS,eAAe,oBAAoB;AACtE,QAAM,cAAc,SAAS,eAAe,cAAc;AAC1D,MAAI,CAAC,YAAa;AAElB,MAAI,gBAAgB,aAAa,MAAM;AACnC,gBAAY,QAAQ;AACpB;AAAA,EACJ;AAEA,MAAI,oBAAoB,WAAW,GAAG;AAClC,gCAA4B,WAAW;AACvC,gBAAY,MAAM,UAAU;AAAA,EAChC,OAAO;AACH,gBAAY,MAAM,UAAU;AAC5B,0BAAsB,WAAW;AAAA,EACrC;AACJ;AAEA,SAAS,4BAA4B,aAAgC;AACjE,QAAM,SAAS,SAAS,eAAe,oBAAoB;AAC3D,MAAI,CAAC,OAAQ;AAEb,SAAO,YAAY;AAEnB,QAAM,UAAU,sBAAsB,WAAW;AACjD,UAAQ,QAAQ,SAAO;AACnB,UAAM,SAAS,SAAS,cAAc,QAAQ;AAC9C,WAAO,QAAQ,IAAI;AACnB,WAAO,cAAc,IAAI;AACzB,WAAO,YAAY,MAAM;AAAA,EAC7B,CAAC;AACL;AAEA,SAAS,sBAAsB,aAAgC;AAC3D,QAAM,SAAS,SAAS,eAAe,cAAc;AACrD,MAAI,CAAC,OAAQ;AAEb,SAAO,YAAY;AAEnB,QAAM,UAAU,wBAAwB,aAAa,WAAW;AAEhE,UAAQ,QAAQ,CAAC,EAAE,OAAO,YAAY,OAAO,MAAM;AAC/C,UAAM,MAAM,SAAS,cAAc,QAAQ;AAC3C,QAAI,QAAQ,GAAG,MAAM,IAAI,UAAU;AACnC,QAAI,cAAc,iBAAiB,OAAO,YAAY,WAAW;AACjE,WAAO,YAAY,GAAG;AAAA,EAC1B,CAAC;AACL;AAEA,SAAS,8BAA8B,aAA0B,QAAsB;AACnF,QAAM,SAAS,SAAS,eAAe,cAAc;AACrD,MAAI,CAAC,OAAQ;AAEb,SAAO,YAAY;AAEnB,QAAM,UAAU,wBAAwB,aAAa,MAAM;AAE3D,UAAQ,QAAQ,CAAC,EAAE,OAAO,YAAY,OAAO,MAAM;AAC/C,UAAM,MAAM,SAAS,cAAc,QAAQ;AAC3C,QAAI,QAAQ,GAAG,MAAM,IAAI,UAAU;AACnC,QAAI,cAAc,iBAAiB,OAAO,YAAY,WAAW;AACjE,WAAO,YAAY,GAAG;AAAA,EAC1B,CAAC;AACL;AASA,SAAS,qCAA2C;AAChD,gBAAc,QAAQ,aAAW;AAC7B,UAAM,UAAU,SAAS,eAAe,WAAW,QAAQ,EAAE,EAAE;AAC/D,QAAI,SAAS;AACT,cAAQ,iBAAiB,SAAS,MAAM,kBAAkB,QAAQ,EAAE,CAAC;AAAA,IACzE;AAAA,EACJ,CAAC;AACL;AAKA,SAAS,+BAAqC;AAC1C,QAAM,oBAAoB,SAAS,eAAe,oBAAoB;AACtE,QAAM,cAAc,SAAS,eAAe,cAAc;AAE1D,MAAI,mBAAmB;AACnB,sBAAkB,iBAAiB,UAAU,MAAM,oBAAoB,CAAC;AAAA,EAC5E;AAEA,MAAI,aAAa;AACb,gBAAY,iBAAiB,UAAU,MAAM;AAEzC,YAAM,aAAa,YAAY;AAC/B,mBAAa,aAAa,EAAE,eAAe,WAAW,CAAC;AAAA,IAE3D,CAAC;AAAA,EACL;AACJ;AAKO,SAAS,mCAAyC;AACrD,qCAAmC;AACnC,+BAA6B;AACjC;AASO,SAAS,kCAA0C;AACtD,SAAO,cAAc,IAAI,aAAW;AAAA,2BACb,QAAQ,EAAE,+DAA+D,QAAQ,KAAK;AAAA,iDAChE,QAAQ,IAAI;AAAA,iDACZ,QAAQ,IAAI;AAAA;AAAA,KAExD,EAAE,KAAK,EAAE;AACd;",
  "names": []
}
